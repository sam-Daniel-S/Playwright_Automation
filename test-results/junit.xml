<testsuites id="" name="" tests="1" failures="1" skipped="0" errors="0" time="243.95136800000003">
<testsuite name="comprehensive-e2e.spec.ts" timestamp="2025-11-27T06:09:56.667Z" hostname="chromium" tests="1" failures="1" skipped="0" time="240.585" errors="0">
<testcase name="Airline Booking - All Scenarios E2E â€º Execute all booking scenarios from test data" classname="comprehensive-e2e.spec.ts" time="240.585">
<failure message="comprehensive-e2e.spec.ts:17:7 Execute all booking scenarios from test data" type="FAILURE">
<![CDATA[  [chromium] â€º comprehensive-e2e.spec.ts:17:7 â€º Airline Booking - All Scenarios E2E â€º Execute all booking scenarios from test data 

    Test timeout of 240000ms exceeded.

    Error: page.screenshot: Target page, context or browser has been closed

      84 |         
      85 |         // Capture failure screenshot
    > 86 |         await page.screenshot({
         |                    ^
      87 |           path: `test-results/scenario-${scenario.scenarioID}-failure.png`,
      88 |           fullPage: true
      89 |         });
        at C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\tests\comprehensive-e2e.spec.ts:86:20

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    ..\test-results\comprehensive-e2e-Airline--6f813-ng-scenarios-from-test-data-chromium\test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    ..\test-results\comprehensive-e2e-Airline--6f813-ng-scenarios-from-test-data-chromium\video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: ..\test-results\comprehensive-e2e-Airline--6f813-ng-scenarios-from-test-data-chromium\error-context.md
]]>
</failure>
<system-out>
<![CDATA[ðŸš€ Starting comprehensive E2E test execution...
ðŸ“ No saved auth state found, performing initial login...
ðŸ”‘ Starting authentication process...
ðŸ” Starting Microsoft authentication process...
ðŸ“ Navigated to login page
âš ï¸  No login button found, checking if login form is present
ðŸ“§ Found email input, attempting automated login...
ðŸ¤– Starting automated Microsoft login...
ðŸ“§ Filling email field...
âž¡ï¸ Clicking Next button...
ðŸ” Filling password field...
ðŸ”‘ Clicking Sign In button...
âœ… Clicking Stay signed in...
â³ Waiting for login completion...
ðŸ”„ Navigating to main application...
ðŸ“ Navigated to: https://app-test-finnair-fra-frontend-f7byg3hef7abafat.germanywestcentral-01.azurewebsites.net/en
âœ… Automated login completed successfully!
ðŸ“ Successfully accessed main application
âœ… Detected /en redirect - User is logged in
âœ… Authentication successful
ðŸ’¾ Authentication state saved
ðŸ’¾ Authentication state saved for future test runs
ðŸ“Š Loading test scenarios...
Reading Excel file: C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\test-data\scenarios.xlsx, sheet: scenarios
Attempting CSV fallback: C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\test-data\scenarios.csv
Reading CSV file: C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\test-data\scenarios.csv
Found 4 scenario(s) with headers: scenarioid, triptype, origin, destination, passengers, cabin, farefamily, dates, tags, expectedresult, timeout
Successfully parsed 4 scenarios
âœ… Loaded 4 test scenarios

ðŸ§ª Executing Scenario: REG_001
ðŸ“‹ One-way | HEL â†’ LHR | Business | 1 ADT,1 CHD
   â±ï¸  Setting timeout to 180000ms
   ðŸ“ Step 1: Filling search form...
Flight search page loaded successfully
Filling search form for scenario: REG_001
Selecting Business class - deselecting Economy first
Configuring passengers for search: [ { type: [32m'ADT'[39m, count: [33m1[39m }, { type: [32m'CHD'[39m, count: [33m1[39m } ]
Passengers needed: 1 adults, 1 children, 0 infants
Setting 1 adults in slot 1
Adding and configuring 1 children
Setting passenger type in slot 2 to Child
âœ… Slot 2 type set to Child
âœ… Passenger configuration completed
Search form filled successfully
Submitting flight search...
Search submitted successfully
   âœˆï¸  Step 2: Processing search results...
Waiting for flight search results...
Flight results loaded successfully
Selecting flight: cabin=Business, preference=first, tripType=One-way
âœ… Continue clicked using FlightSearchLocators
Flight selection completed successfully
   ðŸ‘¤ Step 3: Filling passenger information...
Filling passenger information for 2 passengers
Filling 1 adult passenger(s)
Filling adult passenger 1
Filling adult form 1
âœ… Adult passenger 1 form completed
Filling 1 child passenger(s)
Filling child passenger 1
âœ… Child passenger 1 form completed
Passenger information filled successfully
   ðŸ’³ Step 5: Processing payment with enhanced flow...
Attempting to click Proceed to Payment button
âœ… Country set to India
âœ… Language set to English
Proceed to Payment clicked, waiting for Confirm Payment button
âœ… Payment flow ready
   âœ… Enhanced payment flow completed successfully
âœ… Scenario REG_001 completed successfully

ðŸ§ª Executing Scenario: REG_002
ðŸ“‹ Round-trip | MAA â†’ LHR | Economy | 2 ADT,1 INF
   â±ï¸  Setting timeout to 240000ms
   ðŸ“ Step 1: Filling search form...
Flight search page loaded successfully
Filling search form for scenario: REG_002
Economy is default - opening and closing dropdown
Configuring passengers for search: [ { type: [32m'ADT'[39m, count: [33m2[39m }, { type: [32m'INF'[39m, count: [33m1[39m } ]
Passengers needed: 2 adults, 0 children, 1 infants
Setting 2 adults in slot 1
Increasing passenger count in slot 1 by 1
Plus clicked 1/1 for slot 1
âœ… Passenger count in slot 1 increased by 1
Adding and configuring 1 infants
Setting passenger type in slot 2 to Infant
âœ… Slot 2 type set to Infant
âœ… Passenger configuration completed
Search form filled successfully
Submitting flight search...
Search submitted successfully
   âœˆï¸  Step 2: Processing search results...
Waiting for flight search results...
Flight results loaded successfully
Selecting flight: cabin=Economy, preference=first, tripType=Round-trip
Selecting fare family: Basic
Analyzing failing selector: //span[@data-testid="farename-0-1"]/following-sibling::span[1]
âœ… Continue clicked using FlightSearchLocators
Round-trip detected - waiting 2 seconds for additional continue step
âœ… Continue clicked using fallback selector
âœ… Additional continue step completed for round-trip
Flight selection completed successfully
   ðŸ‘¤ Step 3: Filling passenger information...
Filling passenger information for 3 passengers
Filling 2 adult passenger(s)
Filling adult passenger 1
Filling adult form 1
âœ… Adult passenger 1 form completed
Filling adult passenger 2
Filling adult form 2
âœ… Adult passenger 2 form completed
Filling 1 infant passenger(s)
Filling infant passenger 1
âœ… Infant passenger 1 form completed
Analyzing failing selector: //button[@data-testid="guestdetails_child_continuebtn"]

[[ATTACHMENT|comprehensive-e2e-Airline--6f813-ng-scenarios-from-test-data-chromium\test-failed-1.png]]

[[ATTACHMENT|comprehensive-e2e-Airline--6f813-ng-scenarios-from-test-data-chromium\video.webm]]

[[ATTACHMENT|comprehensive-e2e-Airline--6f813-ng-scenarios-from-test-data-chromium\error-context.md]]
]]>
</system-out>
<system-err>
<![CDATA[Failed to read scenarios from C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\test-data\scenarios.xlsx: Error: ENOENT: no such file or directory, open 'C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\test-data\scenarios.xlsx'
[90m    at Object.openSync (node:fs:573:18)[39m
[90m    at Object.readFileSync (node:fs:452:35)[39m
    at read_binary [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mxlsx[24m\xlsx.js:3153:44[90m)[39m
    at readSync [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mxlsx[24m\xlsx.js:23698:69[90m)[39m
    at Object.readFile [as readFileSync] [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mxlsx[24m\xlsx.js:23738:9[90m)[39m
    at Function.readFromExcel [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mlib\excel\excelReader.ts:51:27[90m)[39m
    at Function.readScenarios [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mlib\excel\excelReader.ts:21:21[90m)[39m
    at [90mC:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mtests\comprehensive-e2e.spec.ts:31:37
    at [90mC:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mplaywright[24m\lib\worker\workerMain.js:310:9
    at [90mC:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mplaywright[24m\lib\worker\testInfo.js:305:11
    at TimeoutManager.withRunnable [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mplaywright[24m\lib\worker\timeoutManager.js:67:14[90m)[39m
    at TestInfoImpl._runWithTimeout [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mplaywright[24m\lib\worker\testInfo.js:303:7[90m)[39m
    at [90mC:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mplaywright[24m\lib\worker\workerMain.js:308:7
    at WorkerMain._runTest [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mplaywright[24m\lib\worker\workerMain.js:283:5[90m)[39m
    at WorkerMain.runTestGroup [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mplaywright[24m\lib\worker\workerMain.js:198:11[90m)[39m
    at process.<anonymous> [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mnode_modules\[4mplaywright[24m\lib\common\process.js:65:22[90m)[39m {
  errno: [33m-4058[39m,
  code: [32m'ENOENT'[39m,
  syscall: [32m'open'[39m,
  path: [32m'C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\test-data\\scenarios.xlsx'[39m
}
Input validation failed. Expected: "Adult1", Actual: ""
Input validation failed. Expected: "Test State", Actual: ""
Input validation failed. Expected: "Child1", Actual: ""
Using fallback selector for Economy class: [data-testid*="flight-result"], .flight-card, .flight-option
Fare family "Basic" not found, using default selection
Wait failed for selector: //span[@data-testid="farename-0-1"]/following-sibling::span[1]
Fare family selection failed: locator.waitFor: Timeout 30000ms exceeded.
Call log:
[2m  - waiting for locator('//span[@data-testid="farename-0-1"]/following-sibling::span[1]').first() to be visible[22m

    at ResultsPage.waitFor [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mpages\BasePage.ts:46:36[90m)[39m
    at ResultsPage.clickWhenReady [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mpages\BasePage.ts:86:16[90m)[39m
    at ResultsPage.selectFareFamily [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mpages\ResultsPage.ts:252:22[90m)[39m
    at ResultsPage.selectFlight [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mpages\ResultsPage.ts:110:9[90m)[39m
    at executeScenario [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mtests\comprehensive-e2e.spec.ts:261:5[90m)[39m
    at [90mC:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mtests\comprehensive-e2e.spec.ts:72:9 {
  name: [32m'TimeoutError'[39m,
  [[32mSymbol(step)[39m]: {
    location: {
      file: [32m'C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\BasePage.ts'[39m,
      line: [33m46[39m,
      column: [33m36[39m,
      function: [32m'ResultsPage.waitFor'[39m
    },
    category: [32m'pw:api'[39m,
    title: [32m`Wait for selector locator('//span[@data-testid="farename-0-1"]/following-sibling::span[1]').first()`[39m,
    apiName: [32m'locator.waitFor'[39m,
    params: {
      selector: [32m'//span[@data-testid="farename-0-1"]/following-sibling::span[1] >> nth=0'[39m,
      strict: [33mtrue[39m,
      omitReturnValue: [33mtrue[39m,
      state: [32m'visible'[39m,
      timeout: [33m30000[39m
    },
    group: [90mundefined[39m,
    stepId: [32m'pw:api@372'[39m,
    boxedStack: [90mundefined[39m,
    steps: [],
    attachmentIndices: [],
    info: TestStepInfoImpl {
      annotations: [],
      _testInfo: [36m[TestInfoImpl][39m,
      _stepId: [32m'pw:api@372'[39m,
      _title: [32m`Wait for selector locator('//span[@data-testid="farename-0-1"]/following-sibling::span[1]').first()`[39m,
      _parentStep: [90mundefined[39m,
      skip: [36m[Function (anonymous)][39m
    },
    complete: [36m[Function: complete][39m,
    endWallTime: [33m1764224001626[39m,
    error: {
      message: [32m'TimeoutError: locator.waitFor: Timeout 30000ms exceeded.\n'[39m +
        [32m'Call log:\n'[39m +
        [32m`\x1B[2m  - waiting for locator('//span[@data-testid="farename-0-1"]/following-sibling::span[1]').first() to be visible\x1B[22m\n`[39m,
      stack: [32m'TimeoutError: locator.waitFor: Timeout 30000ms exceeded.\n'[39m +
        [32m'Call log:\n'[39m +
        [32m`\x1B[2m  - waiting for locator('//span[@data-testid="farename-0-1"]/following-sibling::span[1]').first() to be visible\x1B[22m\n`[39m +
        [32m'\n'[39m +
        [32m'    at ResultsPage.waitFor (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\BasePage.ts:46:36)\n'[39m +
        [32m'    at ResultsPage.clickWhenReady (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\BasePage.ts:86:16)\n'[39m +
        [32m'    at ResultsPage.selectFareFamily (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\ResultsPage.ts:252:22)\n'[39m +
        [32m'    at ResultsPage.selectFlight (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\ResultsPage.ts:110:9)\n'[39m +
        [32m'    at executeScenario (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\tests\\comprehensive-e2e.spec.ts:261:5)\n'[39m +
        [32m'    at C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\tests\\comprehensive-e2e.spec.ts:72:9'[39m,
      cause: [90mundefined[39m
    }
  }
}
Input validation failed. Expected: "Adult1", Actual: ""
Input validation failed. Expected: "Test State", Actual: ""
Input validation failed. Expected: "Adult2", Actual: ""
Input validation failed. Expected: "Test State", Actual: ""
Input validation failed. Expected: "Infant1", Actual: ""
Wait failed for selector: //button[@data-testid="guestdetails_child_continuebtn"]
Failed to fill passenger information: locator.waitFor: Test timeout of 240000ms exceeded.
Call log:
[2m  - waiting for locator('//button[@data-testid="guestdetails_child_continuebtn"]').first() to be visible[22m

    at PassengerInfoPage.waitFor [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mpages\BasePage.ts:46:36[90m)[39m
    at PassengerInfoPage.clickWhenReady [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mpages\BasePage.ts:86:16[90m)[39m
    at PassengerInfoPage.continueToNextStep [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mpages\PassengerInfoPage.ts:362:16[90m)[39m
    at PassengerInfoPage.fillPassengers [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mpages\PassengerInfoPage.ts:84:7[90m)[39m
    at executeScenario [90m(C:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mtests\comprehensive-e2e.spec.ts:280:5[90m)[39m
    at [90mC:\Users\2853064\Documents\Testing\Automation\Playwright_Automation\[39mtests\comprehensive-e2e.spec.ts:72:9 {
  [[32mSymbol(step)[39m]: {
    location: {
      file: [32m'C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\BasePage.ts'[39m,
      line: [33m46[39m,
      column: [33m36[39m,
      function: [32m'PassengerInfoPage.waitFor'[39m
    },
    category: [32m'pw:api'[39m,
    title: [32m`Wait for selector locator('//button[@data-testid="guestdetails_child_continuebtn"]').first()`[39m,
    apiName: [32m'locator.waitFor'[39m,
    params: {
      selector: [32m'//button[@data-testid="guestdetails_child_continuebtn"] >> nth=0'[39m,
      strict: [33mtrue[39m,
      omitReturnValue: [33mtrue[39m,
      state: [32m'visible'[39m,
      timeout: [33m30000[39m
    },
    group: [90mundefined[39m,
    stepId: [32m'pw:api@574'[39m,
    boxedStack: [90mundefined[39m,
    steps: [],
    attachmentIndices: [],
    info: TestStepInfoImpl {
      annotations: [],
      _testInfo: [36m[TestInfoImpl][39m,
      _stepId: [32m'pw:api@574'[39m,
      _title: [32m`Wait for selector locator('//button[@data-testid="guestdetails_child_continuebtn"]').first()`[39m,
      _parentStep: [90mundefined[39m,
      skip: [36m[Function (anonymous)][39m
    },
    complete: [36m[Function: complete][39m,
    endWallTime: [33m1764224038938[39m,
    error: {
      message: [32m'Error: locator.waitFor: Test timeout of 240000ms exceeded.\n'[39m +
        [32m'Call log:\n'[39m +
        [32m`\x1B[2m  - waiting for locator('//button[@data-testid="guestdetails_child_continuebtn"]').first() to be visible\x1B[22m\n`[39m,
      stack: [32m'Error: locator.waitFor: Test timeout of 240000ms exceeded.\n'[39m +
        [32m'Call log:\n'[39m +
        [32m`\x1B[2m  - waiting for locator('//button[@data-testid="guestdetails_child_continuebtn"]').first() to be visible\x1B[22m\n`[39m +
        [32m'\n'[39m +
        [32m'    at PassengerInfoPage.waitFor (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\BasePage.ts:46:36)\n'[39m +
        [32m'    at PassengerInfoPage.clickWhenReady (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\BasePage.ts:86:16)\n'[39m +
        [32m'    at PassengerInfoPage.continueToNextStep (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\PassengerInfoPage.ts:362:16)\n'[39m +
        [32m'    at PassengerInfoPage.fillPassengers (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\pages\\PassengerInfoPage.ts:84:7)\n'[39m +
        [32m'    at executeScenario (C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\tests\\comprehensive-e2e.spec.ts:280:5)\n'[39m +
        [32m'    at C:\\Users\\2853064\\Documents\\Testing\\Automation\\Playwright_Automation\\tests\\comprehensive-e2e.spec.ts:72:9'[39m,
      cause: [90mundefined[39m
    }
  }
}
âŒ Scenario REG_002 failed: Passenger info failed: Error: page.screenshot: Target page, context or browser has been closed
]]>
</system-err>
</testcase>
</testsuite>
</testsuites>