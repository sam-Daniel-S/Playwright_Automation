ğŸš€ Starting comprehensive E2E test execution...
ğŸ”§ Setting up authentication for test execution...
ğŸ”‘ Setting authentication cookie...
ğŸ“‹ Post-authentication status:
   URL: https://app-test-finnair-fra-frontend-f7byg3hef7abafat.germanywestcentral-01.azurewebsites.net/en
   Title: Amadeus Nevio | Finnair
âœ… Cookie authentication successful!
ğŸ’¾ Authentication state saved for future test runs
ğŸ“Š Loading test scenarios...
Reading Excel file: C:\Users\2853064\Documents\Testing\Automation\SingleBase\test-data\scenarios.xlsx, sheet: scenarios
Attempting CSV fallback: C:\Users\2853064\Documents\Testing\Automation\SingleBase\test-data\scenarios.csv
Reading CSV file: C:\Users\2853064\Documents\Testing\Automation\SingleBase\test-data\scenarios.csv
Found 4 scenario(s) with headers: scenario id, action, trip type, origin, destination, date, passengers (ptc), class type, promo code, discounts, loyalty program, member id
Successfully parsed 4 scenarios
âœ… Loaded 4 test scenarios
ğŸ“‹ Scenario 1: ID="scenario_2", Action="Search", HELâ†’LHR
ğŸ“‹ Scenario 2: ID="scenario_3", Action="Results", HELâ†’LHR
ğŸ“‹ Scenario 3: ID="scenario_4", Action="PassengerInfo", LHRâ†’MAA
ğŸ“‹ Scenario 4: ID="scenario_5", Action="Booking", HELâ†’JFK

ğŸ“Š Processing scenario 1 of 4

ğŸ§ª Executing Scenario: scenario_2
ğŸ“‹ Round-trip | HEL â†’ LHR | Economy | 1ADT
ğŸ” Checking browser state for scenario scenario_2...
âœ… Browser state is valid for scenario scenario_2
   â±ï¸  Setting fresh timeout to 18000000ms (18000 seconds) for this scenario
   ğŸš€ Scenario execution started at: 2025-12-02T10:15:36.913Z
   â±ï¸  Starting scenario execution with detailed time tracking
   ğŸ¯ Executing Action: Search
   ğŸ“ Step 1: Filling and submitting search form...
Flight search page loaded successfully
Filling search form for scenario: scenario_2
Economy is default - opening and closing dropdown
Configuring passengers for search: [ { type: 'ADT', count: 1 } ]
Passengers needed: 1 adults, 0 children, 0 infants
Setting 1 adults in slot 1
âœ… Passenger configuration completed
Checking for optional promotional and loyalty fields...
â„¹ï¸ No optional promotional or loyalty fields specified in scenario
Search form filled successfully
Submitting flight search...
Search submitted successfully
Waiting for search results to load...
Verifying search was processed - looking for Flights text
âœ… Found Flights text: "Flights"
âœ… Search results loaded successfully
   âœ… Search completed successfully
   â±ï¸  Scenario execution phase completed in 23592ms
   â±ï¸  Total scenario time so far: 23593ms (24 seconds)
   â±ï¸  Scenario completed in 23593ms (24 seconds)
âœ… Scenario scenario_2 completed successfully
ğŸ”„ Starting cleanup and reset for next scenario...
ğŸ  Navigated to home page for fresh start
âœ… Scenario scenario_2 cleanup completed in 8117ms

ğŸ“Š Processing scenario 2 of 4

ğŸ§ª Executing Scenario: scenario_3
ğŸ“‹ One-way | HEL â†’ LHR | Business | 2ADT
ğŸ” Checking browser state for scenario scenario_3...
âœ… Browser state is valid for scenario scenario_3
   â±ï¸  Setting fresh timeout to 18000000ms (18000 seconds) for this scenario
   ğŸš€ Scenario execution started at: 2025-12-02T10:16:08.630Z
   â±ï¸  Starting scenario execution with detailed time tracking
   ğŸ¯ Executing Action: Results
   ğŸ“ Step 1: Filling and submitting search form...
Flight search page loaded successfully
Filling search form for scenario: scenario_3
Selecting Business class - deselecting Economy first
Configuring passengers for search: [ { type: 'ADT', count: 2 } ]
Passengers needed: 2 adults, 0 children, 0 infants
Setting 2 adults in slot 1
Increasing passenger count in slot 1 by 1
Plus clicked 1/1 for slot 1
âœ… Passenger count in slot 1 increased by 1
âœ… Passenger configuration completed
Checking for optional promotional and loyalty fields...
â„¹ï¸ No optional promotional or loyalty fields specified in scenario
Search form filled successfully
Submitting flight search...
Search submitted successfully
Waiting for search results to load...
Verifying search was processed - looking for Flights text
âœ… Found Flights text: "Flights"
âœ… Search results loaded successfully
   âœ… Search completed successfully
   âœˆï¸  Step 2: Processing search results...
Waiting for search results to load...
About to call selectFlight...
Select a flight from the flight results
Checking if flight selection element is visible...
âœ… Found flight using original locator
âœ… Outbound Flight Selected using original locator
Clicking Continue to proceed to booking
âœ… Clicked Continue to proceed to booking
   âœ… Results processing completed successfully
   â±ï¸  Scenario execution phase completed in 25166ms
   â±ï¸  Total scenario time so far: 25166ms (25 seconds)
   â±ï¸  Scenario completed in 25166ms (25 seconds)
âœ… Scenario scenario_3 completed successfully
ğŸ”„ Starting cleanup and reset for next scenario...
ğŸ  Navigated to home page for fresh start
âœ… Scenario scenario_3 cleanup completed in 8327ms

ğŸ“Š Processing scenario 3 of 4

ğŸ§ª Executing Scenario: scenario_4
ğŸ“‹ One-way | LHR â†’ MAA | Business | 1ADT,1CHD
ğŸ” Checking browser state for scenario scenario_4...
âœ… Browser state is valid for scenario scenario_4
   â±ï¸  Setting fresh timeout to 18000000ms (18000 seconds) for this scenario
   ğŸš€ Scenario execution started at: 2025-12-02T10:16:42.136Z
   â±ï¸  Starting scenario execution with detailed time tracking
   ğŸ¯ Executing Action: PassengerInfo
   ğŸ“ Step 1: Filling and submitting search form...
Flight search page loaded successfully
Filling search form for scenario: scenario_4
Selecting Business class - deselecting Economy first
Configuring passengers for search: [ { type: 'ADT', count: 1 }, { type: 'CHD', count: 1 } ]
Passengers needed: 1 adults, 1 children, 0 infants
Setting 1 adults in slot 1
Adding and configuring 1 children
Setting passenger type in slot 2 to Child
âœ… Slot 2 type set to Child
âœ… Passenger configuration completed
Checking for optional promotional and loyalty fields...
â„¹ï¸ No optional promotional or loyalty fields specified in scenario
Search form filled successfully
Submitting flight search...
Search submitted successfully
Waiting for search results to load...
Verifying search was processed - looking for Flights text
âœ… Found Flights text: "Flights"
âœ… Search results loaded successfully
   âœ… Search completed successfully
   âœˆï¸  Step 2: Processing search results...
Waiting for search results to load...
About to call selectFlight...
Select a flight from the flight results
Checking if flight selection element is visible...
âœ… Found flight using original locator
âœ… Outbound Flight Selected using original locator
Clicking Continue to proceed to booking
âœ… Clicked Continue to proceed to booking
   âœ… Results processing completed successfully
   ğŸ‘¤ Step 3: Filling passenger information...
Filling passenger information for 2 passengers
Filling 1 adult passenger(s)
Filling adult passenger 1
Filling adult form 1
âœ… Adult passenger 1 form completed
Filling 1 child passenger(s)
Filling child passenger 1
âœ… Child passenger 1 form completed
Passenger information filled successfully
   âœ… Passenger information completed successfully
   â±ï¸  Scenario execution phase completed in 45216ms
   â±ï¸  Total scenario time so far: 45217ms (45 seconds)
   â±ï¸  Scenario completed in 45217ms (45 seconds)
âœ… Scenario scenario_4 completed successfully
ğŸ”„ Starting cleanup and reset for next scenario...
ğŸ  Navigated to home page for fresh start
âœ… Scenario scenario_4 cleanup completed in 8759ms

ğŸ“Š Processing scenario 4 of 4

ğŸ§ª Executing Scenario: scenario_5
ğŸ“‹ One-way | HEL â†’ JFK | Economy | 2ADT,2CHD,2INF
ğŸ” Checking browser state for scenario scenario_5...
âœ… Browser state is valid for scenario scenario_5
   â±ï¸  Setting fresh timeout to 18000000ms (18000 seconds) for this scenario
   ğŸš€ Scenario execution started at: 2025-12-02T10:17:36.125Z
   â±ï¸  Starting scenario execution with detailed time tracking
   ğŸ¯ Executing Action: Booking
   ğŸ“ Step 1: Filling and submitting search form...
Flight search page loaded successfully
Filling search form for scenario: scenario_5
Economy is default - opening and closing dropdown
Configuring passengers for search: [
  { type: 'ADT', count: 2 },
  { type: 'CHD', count: 2 },
  { type: 'INF', count: 2 }
]
Passengers needed: 2 adults, 2 children, 2 infants
Setting 2 adults in slot 1
Increasing passenger count in slot 1 by 1
Plus clicked 1/1 for slot 1
âœ… Passenger count in slot 1 increased by 1
Adding and configuring 2 children
Setting passenger type in slot 2 to Child
âœ… Slot 2 type set to Child
Increasing passenger count in slot 2 by 1
Plus clicked 1/1 for slot 2
âœ… Passenger count in slot 2 increased by 1
Adding and configuring 2 infants
Setting passenger type in slot 3 to Infant
âœ… Slot 3 type set to Infant
Increasing passenger count in slot 3 by 1
Plus clicked 1/1 for slot 3
âœ… Passenger count in slot 3 increased by 1
âœ… Passenger configuration completed
Checking for optional promotional and loyalty fields...
â„¹ï¸ No optional promotional or loyalty fields specified in scenario
Search form filled successfully
Submitting flight search...
Search submitted successfully
Waiting for search results to load...
Verifying search was processed - looking for Flights text
âœ… Found Flights text: "Flights"
âœ… Search results loaded successfully
   âœ… Search completed successfully
   âœˆï¸  Step 2: Processing search results...
Waiting for search results to load...
About to call selectFlight...
Select a flight from the flight results
Checking if flight selection element is visible...
âœ… Found flight using original locator
âœ… Outbound Flight Selected using original locator
Clicking Continue to proceed to booking
âœ… Clicked Continue to proceed to booking
   âœ… Results processing completed successfully
   ğŸ‘¤ Step 3: Filling passenger information...
Filling passenger information for 6 passengers
Filling 2 adult passenger(s)
Filling adult passenger 1
Filling adult form 1
âœ… Adult passenger 1 form completed
Filling adult passenger 2
Filling adult form 2
âœ… Adult passenger 2 form completed
Filling 2 child passenger(s)
Filling child passenger 1
âœ… Child passenger 1 form completed
Filling child passenger 2
âœ… Child passenger 2 form completed
Filling 2 infant passenger(s)
Filling infant passenger 1
âœ… Infant passenger 1 form completed
Filling infant passenger 2
âœ… Infant passenger 2 form completed
Passenger information filled successfully
   âœ… Passenger information completed successfully
Attempting to click Proceed to Payment button
âœ… Country set to India
âœ… Language set to English
Proceed to Payment clicked, waiting for Confirm Payment button
âœ… Payment flow ready
   â±ï¸  Scenario execution phase completed in 109985ms
   â±ï¸  Total scenario time so far: 109985ms (110 seconds)
   â±ï¸  Scenario completed in 109985ms (110 seconds)
âœ… Scenario scenario_5 completed successfully
ğŸ”„ Starting cleanup and reset for next scenario...
ğŸ  Navigated to home page for fresh start
âœ… Scenario scenario_5 cleanup completed in 7932ms

ğŸ“Š Test Execution Summary:
   Total Scenarios: 4
   Passed: 4
   Failed: 0
   Success Rate: 100.0%

ğŸ“‹ Detailed Results:
   âœ… scenario_2: PASSED
   âœ… scenario_3: PASSED
   âœ… scenario_4: PASSED
   âœ… scenario_5: PASSED
ğŸ Comprehensive E2E test completed!
